global
    # Set SSL engine to use
    ssl-default-bind-ciphers AES128+EECDH:AES128+EDH

defaults
    # Log format
    log global
    option httplog
    option dontlognull
    timeout connect 5000ms
    timeout client  50000ms
    timeout server  50000ms

frontend http_front
    bind *:80
    bind *:443 ssl crt /etc/letsencrypt/live/www.example.com/fullchain.pem

    # Redirect HTTP to HTTPS
    http-request redirect scheme https unless { ssl_fc }

    default_backend http_back

backend http_back
    server web_server1 127.0.0.1:80

frontend https_front
    bind *:443 ssl crt /etc/letsencrypt/live/kabelomakokga@gmail.com/fullchain.pem

    acl is_root path -i /
    http-request set-var(req.holberton) str(Holberton School) if is_root

    http-response set-header X-Served-By 03-web-01
    http-response set-header X-Frame-Options DENY
    http-response set-header X-Content-Type-Options nosniff
    http-response set-header X-XSS-Protection 1;mode=block

    use_backend http_back if is_root

backend http_back
    server web_server1 127.0.0.1:80

    http-response set-header Content-Security-Policy "default-src 'self'"
    http-response set-header Referrer-Policy "no-referrer"
    http-response set-header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    http-response set-header X-Frame-Options DENY
    http-response set-header X-Content-Type-Options nosniff
    http-response set-header X-XSS-Protection 1;mode=block

    http-response set-header X-Served-By 03-web-01

